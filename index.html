<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Wrapped 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --glass-bg: rgba(255,255,255,0.08);
            --glass-border: rgba(255,255,255,0.12);
            --glow-purple: 0 0 30px rgba(168,85,247,0.5);
            --glow-pink: 0 0 30px rgba(236,72,153,0.5);
        }
        @media (prefers-color-scheme: dark) {
            :root { --glass-bg: rgba(0,0,0,0.4); }
        }
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
        }
        
        /* Spotify Wrapped Animations */
        .slide-up { animation: slideUp 1s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        .flip-in { animation: flipIn 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        .glow-pulse { animation: glowPulse 2s ease-in-out infinite; }
        .card-reveal { animation: cardReveal 0.8s ease-out forwards; }
        .bounce-in { animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(100px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes flipIn {
            0% { transform: rotateX(90deg); opacity: 0; }
            100% { transform: rotateX(0); opacity: 1; }
        }
        @keyframes glowPulse {
            0%, 100% { box-shadow: var(--glow-purple); }
            50% { box-shadow: var(--glow-pink); }
        }
        @keyframes cardReveal {
            0% { clip-path: polygon(0 100%, 100% 100%, 100% 100%, 0 100%); }
            100% { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
        }
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .input-glow:focus { box-shadow: 0 0 0 3px rgba(168,85,247,0.3); }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900/50 to-indigo-900/50 min-h-screen text-white p-4 md:p-8 overflow-hidden">
    <div id="app" class="max-w-4xl mx-auto">
        <!-- Hero Section -->
        <header class="text-center mb-20 slide-up">
            <h1 class="text-5xl md:text-7xl lg:text-8xl font-black bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400 bg-clip-text text-transparent mb-6 drop-shadow-2xl glow-pulse">
                GitHub Wrapped
            </h1>
            <p class="text-xl md:text-2xl opacity-90 font-medium mb-12">Your 2025 coding journey, visualized ‚ú®</p>
        </header>

        <!-- Dynamic Username Input -->
        <div id="input-section" class="glass-card p-12 rounded-4xl max-w-2xl mx-auto mb-20 slide-up">
            <h2 class="text-3xl font-bold mb-8 bg-gradient-to-r from-green-400 to-emerald-400 bg-clip-text text-transparent text-center">Enter GitHub Username</h2>
            <div class="flex gap-4">
                <input id="username-input" type="text" placeholder="github.com/username" 
                       class="flex-1 bg-white/10 backdrop-blur-sm border border-white/20 rounded-3xl px-8 py-6 text-xl font-semibold text-white placeholder-white/60 focus:outline-none focus:ring-4 input-glow transition-all duration-300 hover:border-white/40"
                       autocomplete="username">
                <button id="load-btn" class="bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 px-12 py-6 rounded-3xl font-bold text-xl shadow-2xl hover:shadow-green-500/50 transition-all duration-300 glow-pulse border border-white/20">
                    Generate Wrapped
                </button>
            </div>
            <p class="text-center mt-6 text-sm opacity-70">Works for any public GitHub profile</p>
        </div>

        <!-- Loading -->
        <div id="loading" class="glass-card p-16 rounded-4xl max-w-2xl mx-auto mb-20 hidden text-center slide-up">
            <div class="w-24 h-24 border-4 border-purple-400/30 border-t-purple-400 rounded-full animate-spin mx-auto mb-8"></div>
            <p class="text-2xl font-semibold">Loading your 2025 stats...</p>
        </div>

        <!-- Error -->
        <div id="error" class="glass-card p-12 rounded-4xl max-w-2xl mx-auto mb-20 hidden text-red-400 slide-up">
            <h3 class="text-2xl font-bold mb-6">‚ö†Ô∏è Invalid username or private profile</h3>
            <p id="error-message" class="text-lg mb-8"></p>
            <button id="retry-btn" class="w-full bg-gradient-to-r from-red-500 to-red-600 px-12 py-4 rounded-3xl font-bold text-lg shadow-2xl hover:shadow-red-500/50 transition-all duration-300">Try Again</button>
        </div>

        <!-- Stats Grid -->
        <div id="stats-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 hidden">
            <!-- Total Stats -->
            <div class="glass-card p-8 rounded-4xl shadow-2xl card-reveal hover:shadow-purple-500/40 transition-all duration-500 group">
                <h2 class="text-2xl font-bold mb-8 text-center bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">Total Impact 2025</h2>
                <img id="stats-card" class="w-full rounded-3xl shadow-2xl mx-auto block group-hover:scale-105 transition-transform duration-300" src="" alt="Stats">
                <div id="user-stats" class="mt-6 text-center space-y-2 hidden">
                    <p class="text-2xl font-bold text-white"><span id="repos-count">-</span> Repos</p>
                    <p class="text-lg opacity-80"><span id="followers-count">-</span> Followers</p>
                </div>
            </div>

            <!-- Top Languages -->
            <div class="glass-card p-8 rounded-4xl shadow-2xl card-reveal hover:shadow-blue-500/40 transition-all duration-500 group md:col-span-2 lg:col-span-1">
                <h2 class="text-2xl font-bold mb-8 text-center bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent">Top Languages</h2>
                <img id="langs-card" class="w-full rounded-3xl shadow-2xl mx-auto block group-hover:scale-105 transition-transform duration-300" src="" alt="Languages">
            </div>

            <!-- Activity Heatmap -->
            <div class="glass-card p-8 rounded-4xl shadow-2xl card-reveal hover:shadow-green-500/40 transition-all duration-500 group md:col-span-2">
                <h2 class="text-2xl font-bold mb-8 text-center bg-gradient-to-r from-green-400 to-emerald-400 bg-clip-text text-transparent">Activity Heatmap</h2>
                <canvas id="heatmap" class="w-full h-80 rounded-3xl bg-gradient-to-r from-green-500/20 to-emerald-500/20 shadow-2xl"></canvas>
            </div>
        </div>

        <!-- Share -->
        <div id="share-section" class="glass-card p-16 rounded-4xl shadow-2xl mt-24 mx-auto max-w-3xl text-center hidden bounce-in glow-pulse">
            <h2 class="text-4xl font-black mb-12 bg-gradient-to-r from-pink-400 via-purple-400 to-pink-400 bg-clip-text text-transparent">Share Your Wrapped ‚ú®</h2>
            <button id="share-btn" class="w-full bg-gradient-to-r from-pink-500 via-purple-500 to-pink-500 hover:from-pink-600 hover:via-purple-600 hover:to-pink-600 px-16 py-8 rounded-4xl font-black text-2xl shadow-2xl hover:shadow-pink-500/60 transition-all duration-500 border-2 border-white/30 glow-pulse">
                üì± Share to Social Media
            </button>
            <p class="mt-8 text-lg opacity-80 font-medium">Made with ‚ù§Ô∏è for developers</p>
        </div>
    </div>

    <script>
        let currentUsername = '';
        const cards = {
            stats: document.getElementById('stats-card'),
            langs: document.getElementById('langs-card')
        };

        // Input handling
        document.getElementById('load-btn').addEventListener('click', loadStats);
        document.getElementById('username-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') loadStats();
        });
        document.getElementById('retry-btn').addEventListener('click', () => {
            document.getElementById('error').classList.add('hidden');
            document.getElementById('input-section').classList.remove('hidden');
        });

        async function loadStats() {
            currentUsername = document.getElementById('username-input').value.trim().toLowerCase();
            
            if (!currentUsername || !currentUsername.includes('.')) {
                showError('Enter a valid GitHub username (e.g., "torvalds")');
                return;
            }

            hideAllSections();
            document.getElementById('loading').classList.remove('hidden');
            
            try {
                // Test API with username
                const apiResponse = await fetch('/api/stats?username=' + currentUsername);
                
                if (!apiResponse.ok) {
                    const errorData = await apiResponse.json();
                    throw new Error(errorData.error || `API Error: ${apiResponse.status}`);
                }
                
                const data = await apiResponse.json();
                
                // Load stats cards (public API)
                cards.stats.src = `https://github-readme-stats.vercel.app/api?username=${currentUsername}&show_icons=true&theme=dracula&hide_border=true&bg_color=0D111700&hide=issues,contribs&border_radius=32&title_color=f85d7f&text_color=ffffff&icon_color=5865f2`;
                cards.langs.src = `https://github-readme-stats.vercel.app/api/top-langs/?username=${currentUsername}&layout=donut&theme=dracula&hide_border=true&bg_color=0D111700&border_radius=32`;
                
                // Update user stats
                document.getElementById('repos-count').textContent = data.totalRepos;
                document.getElementById('followers-count').textContent = data.followers;
                document.getElementById('user-stats').classList.remove('hidden');
                
                // Animate heatmap
                drawAnimatedHeatmap();
                
                // Show results with stagger
                setTimeout(() => document.getElementById('stats-grid').classList.remove('hidden'), 500);
                setTimeout(() => document.getElementById('share-section').classList.remove('hidden'), 1000);
                
            } catch (error) {
                showError(error.message);
            } finally {
                document.getElementById('loading').classList.add('hidden');
            }
        }

        function hideAllSections() {
            document.getElementById('stats-grid').classList.add('hidden');
            document.getElementById('share-section').classList.add('hidden');
            document.getElementById('error').classList.add('hidden');
        }

        function showError(message) {
            document.getElementById('error-message').textContent = message;
            document.getElementById('error').classList.remove('hidden');
            document.getElementById('input-section').classList.remove('hidden');
        }

        function drawAnimatedHeatmap() {
            const canvas = document.getElementById('heatmap');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth * 2;
            canvas.height = canvas.offsetHeight * 2;
            ctx.scale(2, 2);
            
            const time = Date.now() * 0.005;
            for (let x = 0; x < canvas.offsetWidth; x += 20) {
                for (let y = 0; y < canvas.offsetHeight; y += 20) {
                    const intensity = (Math.sin(x * 0.1 + time) + Math.sin(y * 0.15 + time)) * 0.5 + 0.5;
                    const gradient = ctx.createRadialGradient(x, y, 0, x, y, 20);
                    gradient.addColorStop(0, `rgba(34,197,94,${intensity * 0.6})`);
                    gradient.addColorStop(1, 'rgba(34,197,94,0)');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(x, y, 20, 20);
                }
            }
        }

        // Share
        document.getElementById('share-btn').addEventListener('click', () => {
            const shareUrl = `${window.location.href}?user=${currentUsername}`;
            if (navigator.share) {
                navigator.share({ 
                    title: `My GitHub Wrapped 2025`, 
                    text: `Check out ${currentUsername}'s 2025 GitHub stats!`, 
                    url: shareUrl 
                });
            } else {
                navigator.clipboard.writeText(shareUrl);
                alert('Link copied to clipboard! üìã');
            }
        });

        // Animate on resize
        window.addEventListener('resize', drawAnimatedHeatmap);
    </script>
</body>
</html>
